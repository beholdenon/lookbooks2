<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Bloomingdale's</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">

		<link href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,700|Roboto+Mono:300,700" rel="stylesheet">

		<link rel="stylesheet" type="text/css" href="./css/styles.css" />
	</head>
	<body>
		<div class="resort-template">
			<main>
				<div class="static-left-nav">
					<h1></h1>
					<ul>
					</ul>
				</div>
				<div class="content">
					<!--<div class="row section" id="section1">
						<div>
							<img src="./images/resort/resort-1.jpg" data-aos="fade-up">
						</div>
					</div>

					<div class="row">
						<div>
							<img src="./images/resort/resort-2.jpg" data-aos="fade-up">
						</div>
						<div data-aos="fade-up" class="textRow">
							<h2>The Power of Flowers</h2>
							<p>Florals for spring. We know, groundbreaking. But stick with us. There’s a reason this perennial print keeps popping up each year. The same jolt of joy that comes with spotting the first daffodil of the season can be felt in observing springlike blooms bursting across breezy shoulder-baring dresses, statement-sleeve tops or a beach-cruiser-ready jumpsuit. This season in particular, we’re pairing blossoms from abstract and oversized to delicate and dainty with of-the-moment denim like wrap skirts, cropped jeans and oversized jackets for a look that’s as casually cool as the Venice scene.</p> 
							<a href="#" class="large">Shop the Trend</a>
						</div>
					</div>

					<div class="row">
						<div>
							<div class="products" data-aos="fade-up">
								<div>
									<a href="#">
										<img src="./images/resort/thumb13.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb14.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb15.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb16.jpg">Shop The Look
									</a>
								</div>
							</div>
						</div>
						<div>
							<img src="./images/resort/resort-4.jpg" data-aos="fade-up">
						</div>
					</div>

					<div class="row">
						<div>
							<img src="./images/resort/resort-5.jpg" data-aos="fade-up">
						</div>
						<div>
							<img src="./images/resort/resort-6.jpg" data-aos="fade-up">
						</div>
					</div>

					<div class="row section" id="section2">
						<div>
							<img src="./images/resort/resort-7.jpg" data-aos="fade-up">
						</div>
					</div>

					<div class="row">
						<div>
							<img src="./images/resort/resort-8.jpg" data-aos="fade-up">
						</div>
						<div data-aos="fade-up" class="textRow">
							<h2>Stripes' New Bandwidth</h2>
							<p>Florals for spring. We know, groundbreaking. But stick with us. There’s a reason this perennial print keeps popping up each year. The same jolt of joy that comes with spotting the first daffodil of the season can be felt in observing springlike blooms bursting across breezy shoulder-baring dresses, statement-sleeve tops or a beach-cruiser-ready jumpsuit. This season in particular, we’re pairing blossoms from abstract and oversized to delicate and dainty with of-the-moment denim like wrap skirts, cropped jeans and oversized jackets for a look that’s as casually cool as the Venice scene.</p> 
							<a href="#" class="large">Shop the Trend</a>
						</div>
					</div>

					<div class="row">
						<div>
							<div class="products" data-aos="fade-up">
								<div>
									<a href="#">
										<img src="./images/resort/thumb9.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb10.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb11.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb12.jpg">Shop The Look
									</a>
								</div>
							</div>
						</div>
						<div>
							<img src="./images/resort/resort-10.jpg" data-aos="fade-up">
						</div>
					</div>

					<div class="row">
						<div>
							<img src="./images/resort/resort-11.jpg" data-aos="fade-up">
						</div>
						<div>
							<img src="./images/resort/resort-12.jpg" data-aos="fade-up">
						</div>
					</div>

					
					<div class="row section" id="section3">
						<div>
							<img src="./images/resort/resort-13.jpg" data-aos="fade-up">
						</div>
					</div>

					<div class="row">
						<div>
							<img src="./images/resort/resort-14.jpg" data-aos="fade-up">
						</div>
						<div data-aos="fade-up" class="textRow">
							<h2>Dressed to Frill</h2>
							<p>Florals for spring. We know, groundbreaking. But stick with us. There’s a reason this perennial print keeps popping up each year. The same jolt of joy that comes with spotting the first daffodil of the season can be felt in observing springlike blooms bursting across breezy shoulder-baring dresses, statement-sleeve tops or a beach-cruiser-ready jumpsuit. This season in particular, we’re pairing blossoms from abstract and oversized to delicate and dainty with of-the-moment denim like wrap skirts, cropped jeans and oversized jackets for a look that’s as casually cool as the Venice scene.</p> 
							<a href="#" class="large">Shop the Trend</a>
						</div>
					</div>

					<div class="row">
						<div>
							<div class="products" data-aos="fade-up">
								<div>
									<a href="#">
										<img src="./images/resort/thumb5.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb6.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb7.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb8.jpg">Shop The Look
									</a>
								</div>
							</div>
						</div>
						<div>
							<img src="./images/resort/resort-15.jpg" data-aos="fade-up">
						</div>
					</div>

					<div class="row">
						<div>
							<img src="./images/resort/resort-21.jpg" data-aos="fade-up">
						</div>
						<div>
							<img src="./images/resort/resort-22.jpg" data-aos="fade-up">
						</div>
					</div>


					<div class="row section" id="section4">
						<div>
							<img src="./images/resort/resort-16.jpg" data-aos="fade-up">
						</div>
					</div>

					<div class="row">
						<div>
							<img src="./images/resort/resort-17.jpg" data-aos="fade-up">
						</div>
						<div data-aos="fade-up" class="textRow">
							<h2>The Splash Zone</h2>
							<p>Florals for spring. We know, groundbreaking. But stick with us. There’s a reason this perennial print keeps popping up each year. The same jolt of joy that comes with spotting the first daffodil of the season can be felt in observing springlike blooms bursting across breezy shoulder-baring dresses, statement-sleeve tops or a beach-cruiser-ready jumpsuit. This season in particular, we’re pairing blossoms from abstract and oversized to delicate and dainty with of-the-moment denim like wrap skirts, cropped jeans and oversized jackets for a look that’s as casually cool as the Venice scene.</p> 
							<a href="#" class="large">Shop the Trend</a>
						</div>
					</div>

					<div class="row">
						<div>
							<div class="products" data-aos="fade-up">
								<div>
									<a href="#">
										<img src="./images/resort/thumb1.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb2.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb3.jpg">Shop The Look
									</a>
								</div>
								<div>
									<a href="#">
										<img src="./images/resort/thumb4.jpg">Shop The Look
									</a>
								</div>
							</div>
						</div>
						<div>
							<img src="./images/resort/resort-18.jpg" data-aos="fade-up">
						</div>
					</div>
					<div class="row">
						<div>
							<img src="./images/resort/resort-19.jpg" data-aos="fade-up">
						</div>
						<div>
							<img src="./images/resort/resort-20.jpg" data-aos="fade-up">
						</div>
					</div>


-->
				</div>

				
			<img src="./images/resort/arrow.png" class="arrow">
		</main>
		

	</div>
	
	<footer class="resort-footer">
		<div class="row">
			<div>
				<h3>follow us @bloomingdales</h3>
				<ul>
					<li><a href="#">Facebook</a></li>
					<li><a href="#">Twitter</a></li>
					<li><a href="#">Pinterest</a></li>
					<li><a href="#">Instagram</a></li>
					<li><a href="#">Snapchat</a></li>
				</ul>
			</div>
		</div>
	</footer>

		<script src="./js/app.js"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.8.6/showdown.min.js"></script>
		<script src="https://npmcdn.com/contentful@3.3.5/browser-dist/contentful.js"></script>
		<script>
			$(function() {

				// array to build dynamic nav
				var navArray = [];
				var navNameArray = [];

				// initiate an instance of the markdown converter
				var converter = new showdown.Converter()

				// return clean html when passed markdown
			  	function convertMarkdown(str) {
			  		return converter.makeHtml(str);
			  	}
				var activeSection;
				function setSection(id) {
					console.log($("#" + navArray[id]).offset().top);
					$('html, body').animate({
        				scrollTop: $("#" + navArray[id]).offset().top -30
    				}, 1000);
    				setActiveNav(id);
				}
				
				function setActiveNav(id) {
					$(".static-left-nav ul li a.active").removeClass("active");
    				$(".static-left-nav ul li").eq(id).find("a").addClass("active");
				}
				function buildDynamicNav() {
					var nav = "";
		    		for(var i = 0; i < navNameArray.length; i ++) {
		    			nav += '<li><a href="#">' + navNameArray[i] + '</a></li>';
		    		}
					nav += '<li><a href="#">Back to bloomingdales.com</a></li>';
		    		$(".static-left-nav ul").html(nav);
				}
				function setNav() {
					buildDynamicNav();
					setActiveNav(0);
					$(".static-left-nav ul li").on("click", function() {
						setSection($(this).index());
					});
					$(window).on("scroll", function() {
						$(".section").each(function(index) {
							if($(window).scrollTop() >= ($("#" + navArray[index]).offset().top-10)) {
								activeSection = index;
							}
							//console.log(activeSection);
							setActiveNav(activeSection);
						});
					});
					$(".arrow").on("click", function() {
						$('html, body').animate({ scrollTop: 0 }, 1000);
					});
				}
				
				function getUrlParameter(name) {
				    name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
				    var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
				    var results = regex.exec(location.search);
				    return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
				};
				function node(type, obj, content) {
					if(!type) return "";
					var node = $("<" + type + "/>", obj);
					if(content) node.append(content);
					return node;
				}
				function setStylesheet(hex) {
					var style = document.createElement('style');
					style.type = 'text/css';
					style.innerHTML = '.resort-template .static-left-nav ul li a.active { background: #' + hex + '; }';
					style.innerHTML += '.resort-template .static-left-nav ul li a:hover { background: #' + hex + '; }';
					style.innerHTML += '.resort-template .textRow a:hover { background: #' + hex + '; }';
					style.innerHTML += 'footer.resort-footer  { background: #' + hex + '; }';
					document.getElementsByTagName('head')[0].appendChild(style);
				}
				// initiate the contentful api
				var client = contentful.createClient({
			    	space: 'm3h9iuk14rnq',
			    	accessToken: '867b911445d5af9f570b8d1ebe34769a136084ce6deb7f212ac1d34938579bc4'
			  	})
				// get the entry based on id querystring or pull last lookbookA
				client.getEntries({
				    content_type: "lookbookA",
  					'sys.id': getUrlParameter("id"),
				    include: 10,
				    limit: 1
				})
				.then(function(entries) {
				    $.each(entries.items, function(i, item) {

				    	// set the h1 headline of the lookbook
				    	$(".static-left-nav h1").html(item.fields.headline);

				    	// set the page title
				    	document.title = item.fields.lookbookTitle;

				    	// get secondary color and build stylesheet
				    	var hex = item.fields.secondaryHexValue || "ffffff";
				    	setStylesheet(hex);

				    	// loop through each row
				    	$.each(item.fields.rows, function (r, rowItem) {
				    		// each row content
				    		var anchor = rowItem.fields.anchorTitle;
				    		
				    		var rowObj;
				    		if(anchor) {
				    			navNameArray.push(anchor);
				    			anchor = anchor.replace(/\s/g, '');
				    			navArray.push(anchor);
				    			rowObj = node("div", {class: "row section", id: anchor });
				    		}
				    		else {
				    			rowObj= node("div", {class: "row"});
				    		}

				    		$.each(rowItem.fields.content2, function (c, contentItem) {
				    			if(contentItem.sys.contentType.sys.id === "text") {
				    				// text content
				    				var textContent = contentItem.fields.text;
				    				
				    				rowObj.append(
				    					node("div", {class: "textRow"}, convertMarkdown(textContent))
				    				);
				    			}
				    			else if(contentItem.sys.contentType.sys.id === "photo") {
				    				// found photo content
				    				var altText = contentItem.fields.altText;
				    				
				    				// photo
				    				var photo = contentItem.fields.photo.fields.file.url;
				    				
				    				// url
				    				var url = contentItem.fields.link;

				    				// caption
				    				var caption = contentItem.fields.caption || "";

				    				var photoDiv = node("div");
				    				var imgObj;
				    				if(url) {
				    					imgObj = node("a", {href: url}).append(
				    						node("img", {src: photo, alt: altText})
				    					)
				    				}
				    				else {
				    					imgObj = node("img", {src: photo, alt: altText})
				    				}
				    				imgObj.append(caption);
				    				photoDiv.append(imgObj);
									rowObj.append(photoDiv);

				    			}
				    			else if(contentItem.sys.contentType.sys.id === "productGrid") {
				    				// found a product grid

				    				var prodGridObj = node("div");
				    				var prodObj = node("div", {class: "products"})
				    				prodGridObj.append(prodObj);

				    				// loop through each product
				    				$.each(contentItem.fields.products, function (p, productItem) {
				    					var productImage = productItem.fields.photo.fields.file.url;
				    					var productAltText = productItem.fields.altText;
				    					var productCaption = productItem.fields.caption;
				    					var productLink = productItem.fields.link;

				    					prodObj.append(
				    						node("div").append(
				    							node("a", {href: productLink}).append(
				    								node("img", {src: productImage, alt: productAltText})
				    							).append(productCaption)
				    						)
				    					)
				    				});
				    				rowObj.append(prodGridObj);
				    			}
				    		});
				    		rowObj.attr("data-aos", "fade-up");
				    		$(".content").append(rowObj);
				    	});
				    });

				    // set the html content
				    /*$(".content").append(html);*/

				    // init animation
				    AOS.init();

				    // build nav
				    setNav();
				});
			});
		</script>


	</body>
</html>